<project name="vulcan-lib" default="help" basedir="."
	 xmlns:ivy="antlib:org.apache.ivy.ant"
	 xmlns:jsl="antlib:com.googlecode.jslint4java">

	<description>Vulcan dependency libraries</description>

	<!-- set global properties for this build -->
	<property name="lib.dir" location="lib"/>
	<mkdir dir="${lib.dir}"/>


	<path id="ant.tasks.classpath">
		<fileset dir="lib" includes="*.jar" />
	</path>

	<taskdef uri="antlib:com.googlecode.jslint4java"
		 resource="com/googlecode/jslint4java/antlib.xml"
		 classpathref="ant.tasks.classpath"/>


	<target name="resolve" description="--> retrieve dependencies with ivy">
		<ivy:retrieve/>
	</target>


	<target name="get-qunit" description="--> get qunit files">
		<get src="http://code.jquery.com/qunit/qunit-git.css" dest="${lib.dir}/qunit-git.css"/>
		<get src="http://code.jquery.com/qunit/qunit-git.js" dest="${lib.dir}/qunit-git.js"/>
	</target>


	<target name="get-jquery" description="--> get jquery from googleapis">
		<get src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" dest="${lib.dir}/jquery-1.7.1-min.js"/>
	</target>


<!-- TODO none of these node/npm calls are reliable on windows7
		try this:

		cd src
		npm install express
		node node_modules/express/bin/express -t ejs
		(answer Y when prompted)
		node install
	-->
	<target name="get-node">
		<echo>Assuming node.js and npm are installed</echo>
	</target>


	<target name="get-express">
		<exec dir="${source.dir}" executable="npm">
			<arg value="install"/>
			<arg value="express"/>
		</exec>
	</target>


	<target name="init-express" depends="get-express">
		<exec dir="${source.dir}" executable="node">
			<arg value="node_modules/express/bin/express"/>
			<arg value="install"/>
			<arg value="express"/>
			<arg value="-t"/>
			<arg value="ejs"/>
		</exec>
	</target>


	<target name="lib.init" depends="resolve,get-qunit,get-jquery"/>


</project>
